<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Submit Request">d9e1dbdbdbda1010a458cd3f299619a7</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"4563dbfed80c46e68eb98723b9523258","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"4563dbfed80c46e68eb98723b9523258"}],"goals":[{"name":"primary","trigger_id":"4563dbfed80c46e68eb98723b9523258","nodes":[{"type":"StartGoal","goal_id":"76f589eb2b64462b984e070a2de1745a","greeting_msg":{"type":"String","mode":"string","value":""},"id":"d5924f73d2eb4fbebccf34501a5bad30","name":"Start"},{"type":"TerminateGoal","goal_id":"76f589eb2b64462b984e070a2de1745a","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"ad4037f4d6574126bd6b4acb4938f6e1","name":"End"},{"type":"LibraryCall","library_topic_name":"Search Catalog Item","library_topic_id":"ccaacd71c3a3330012d1758a7ff57ecd","parameter-mappings":[{"parameter-name":"catalogs","value":{"type":"String","mode":"string","value":"{{vaVars.catalogs_tobe_searched}}"}},{"parameter-name":"query_term","value":{"type":"String","mode":"string","value":"{{vaInputs.search_term}}"}}],"return-value-mappings":[{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"catalog_item_id","main_topic_mapped_variable_name":"catalog_item_id"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"item_type","main_topic_mapped_variable_name":"item_type"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"is_conversational","main_topic_mapped_variable_name":"is_conversational"}],"id":"af5401dfeef64080b3995353ab98d7b4","name":"Search Catalog Item","goal_id":"76f589eb2b64462b984e070a2de1745a"},{"type":"InputPrompt","variable_id":"ae98d01e23de40f8895f9824b02f7d75","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"What are you looking for?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","name":"searchquery","allow_text_input":true,"use_confirmation_prompt":false},"optional":false,"id":"2352136af4be4b2da747515bcfc5a088","name":"Search Term","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Please click on the link below to complete the request:\", vaContext.getRequesterLang())"},"label":{"type":"String","mode":"script","value":"(function execute() {\n    return JSON.parse(vaVars.selected_item).title;\n})()\n"},"url":{"type":"String","mode":"script","value":"(function execute() {\n    return vaVars.baseUri+JSON.parse(vaVars.selected_item).selected_link;\n})()\n"},"link_type":"single","multi_link_script":"","id":"debbc86be43541499113624ad48f5481","name":"Display link","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n        var catItemObj = new sn_sc.CatItem(vaInputs.catalog_item_id);\n        var catItemJson = catItemObj.read({\n            \"name\" : \"\"\n        }, true);\n        var itemJSON = {'sys_id': vaInputs.catalog_item_id, 'title': catItemJson.name, 'selected_link':''};\n        if(vaVars.portal == null)\n            itemJSON.selected_link = vaVars.default_portal;\n        else\n            itemJSON.selected_link = vaVars.portal;\n        itemJSON.selected_link = itemJSON.selected_link + '?id=sc_cat_item&amp;sys_id=' + vaInputs.catalog_item_id;\n        vaVars.selected_item = JSON.stringify(itemJSON);\n})()\n","id":"e4e466b6614c44f193f131c413c76227","name":"Fetch Catalog Info","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"953f7311b0c54ccda1a33129eb184073","message":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage('Do you want to proceed with \\'{0}\\'?', [JSON.parse(vaVars.selected_item).title]);\n})()\n"},"nlu_entity_binding":{"type":"NLUEntityBinding","name":"","allow_text_input":false,"use_confirmation_prompt":true},"optional":false,"id":"551e71e4749f4ed3913360c48752a0da","name":"Proceed","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Yes","expression":{"type":"Applicability","mode":"query","value":"proceed=true"},"id":"4c0e74a975154f95b09000b9fd707be7","name":"Yes"},{"type":"Branch","label":"No","expression":{"type":"Applicability","mode":"query","value":"proceed="},"id":"ddaee5c1bd3647289f949a7d7e35c8fa","name":"No"}],"id":"74c4991835f04187ad6d4d2ca7231c18","goal_id":"76f589eb2b64462b984e070a2de1745a"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Okay, let's try again\", vaContext.getRequesterLang())"},"id":"0afd6917407643fba383d469ad6a7202","name":"Try again","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Catalog item selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISNOTEMPTY"},"id":"2c2e11e9e0a2472da9e7e30b9812505a","name":"Catalog item selected"},{"type":"Branch","label":"No Catalog selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISEMPTY"},"id":"f1d2ffa24fc64422aa230d58db74dec3","name":"No Catalog selected"}],"id":"982c153b0187414cb093fa713a3ffa9f","goal_id":"76f589eb2b64462b984e070a2de1745a"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Sorry, but I couldn't find any relevant items.\", vaContext.getRequesterLang())"},"id":"78f2307fb5c740b694d4227c7406e5c4","name":"No Catalog items ack","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"true","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (!gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal)) || gs.nil(vaVars.portal);\n})()\n"},"id":"4c473b28a57a4c109f18cdcfaac9570b","name":"true"},{"type":"Branch","label":"false","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal));\n})()\n"},"id":"53a3ba140db24a618769fa15a4a13a94","name":"false"}],"id":"5ed16fb2251b41c3864294f82bd59655","goal_id":"76f589eb2b64462b984e070a2de1745a"},{"type":"ScriptedAction","script":"(function execute() {\n    var catalogArray = [];\n    if(!gs.nil(vaVars.portal)) {\n        var portal_catalog = new GlideRecord('m2m_sp_portal_catalog');\n        portal_catalog.addQuery('sp_portal.url_suffix', vaVars.portal);\n        portal_catalog.addActiveQuery();\n        portal_catalog.query();\n        \n        while (portal_catalog.next()) {\n            catalogArray.push(portal_catalog.getValue('sc_catalog'));\n        }\n    }\n    vaVars.catalogs_tobe_searched = catalogArray.join();\n})()\n","id":"4fde382890d74d74b693e55c439d4681","name":"Portal Catalogs","goal_id":"76f589eb2b64462b984e070a2de1745a","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"d5924f73d2eb4fbebccf34501a5bad30","target_node_id":"2352136af4be4b2da747515bcfc5a088","id":"90d927961d42474eab15a98cd9e59ddf"},{"type":"Edge","source_node_id":"e4e466b6614c44f193f131c413c76227","target_node_id":"551e71e4749f4ed3913360c48752a0da","id":"c4e28bb67bc841a38dc3483e5cca2caf"},{"type":"Edge","source_node_id":"debbc86be43541499113624ad48f5481","target_node_id":"ad4037f4d6574126bd6b4acb4938f6e1","id":"b1b0bd7b27bd434487631f6efdcba06f"},{"type":"Edge","source_node_id":"551e71e4749f4ed3913360c48752a0da","target_node_id":"74c4991835f04187ad6d4d2ca7231c18","id":"146cd496d48e4d808c93ead90fabb6ea"},{"type":"Edge","source_node_id":"74c4991835f04187ad6d4d2ca7231c18","target_node_id":"debbc86be43541499113624ad48f5481","branch_id":"4c0e74a975154f95b09000b9fd707be7","id":"aa0b07bce57a4bca936a74b52b343e2e","name":"4c0e74a975154f95b09000b9fd707be7"},{"type":"Edge","source_node_id":"74c4991835f04187ad6d4d2ca7231c18","target_node_id":"0afd6917407643fba383d469ad6a7202","branch_id":"ddaee5c1bd3647289f949a7d7e35c8fa","id":"bf08ddaab4f94324a1811a6253472bfc","name":"ddaee5c1bd3647289f949a7d7e35c8fa"},{"type":"Edge","source_node_id":"0afd6917407643fba383d469ad6a7202","target_node_id":"2352136af4be4b2da747515bcfc5a088","id":"ea31646481a4426c93c7620c37b53e5b"},{"type":"Edge","source_node_id":"af5401dfeef64080b3995353ab98d7b4","target_node_id":"982c153b0187414cb093fa713a3ffa9f","id":"aa9fbfab802c4d7f978dcb99a7eae80b"},{"type":"Edge","source_node_id":"78f2307fb5c740b694d4227c7406e5c4","target_node_id":"ad4037f4d6574126bd6b4acb4938f6e1","id":"0557ab7331e84707a9295f2cf83e441a"},{"type":"Edge","source_node_id":"982c153b0187414cb093fa713a3ffa9f","target_node_id":"e4e466b6614c44f193f131c413c76227","branch_id":"2c2e11e9e0a2472da9e7e30b9812505a","id":"2ca3b361df9e42d49c945562db033c19","name":"2c2e11e9e0a2472da9e7e30b9812505a"},{"type":"Edge","source_node_id":"982c153b0187414cb093fa713a3ffa9f","target_node_id":"78f2307fb5c740b694d4227c7406e5c4","branch_id":"f1d2ffa24fc64422aa230d58db74dec3","id":"f0ff9beca704498bb9ec58481159eb1d","name":"f1d2ffa24fc64422aa230d58db74dec3"},{"type":"Edge","source_node_id":"5ed16fb2251b41c3864294f82bd59655","target_node_id":"af5401dfeef64080b3995353ab98d7b4","branch_id":"4c473b28a57a4c109f18cdcfaac9570b","id":"21250f5fceb242e2a97e0f3c94fcbbec","name":"4c473b28a57a4c109f18cdcfaac9570b"},{"type":"Edge","source_node_id":"5ed16fb2251b41c3864294f82bd59655","target_node_id":"78f2307fb5c740b694d4227c7406e5c4","branch_id":"53a3ba140db24a618769fa15a4a13a94","id":"ccdb71585d3347dc818020403d984746","name":"53a3ba140db24a618769fa15a4a13a94"},{"type":"Edge","source_node_id":"2352136af4be4b2da747515bcfc5a088","target_node_id":"4fde382890d74d74b693e55c439d4681","id":"a8776467dddb44228e1244db9bac6a0a"},{"type":"Edge","source_node_id":"4fde382890d74d74b693e55c439d4681","target_node_id":"5ed16fb2251b41c3864294f82bd59655","id":"5f663bcb4f344ed3877db51beea2afa5"}],"id":"76f589eb2b64462b984e070a2de1745a"}],"script_variables":[{"type":"String","name":"selected_item","value":{"type":"String","mode":"string"},"id":"007c5a74016e415ca33d239f819eb34f"},{"type":"String","name":"portal","value":{"type":"String","mode":"script","value":"(function execute() {\n    return vaContext.portal == undefined ? null : vaContext.portal;\n})()"},"id":"7f5f028f3cc24bc69f9c4f06c506696b"},{"type":"String","name":"default_portal","value":{"type":"String","mode":"string","value":"csm"},"id":"3bfbfbde17d249ca877576a347a8de4f"},{"type":"String","name":"baseUri","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri');\n})()\n"},"id":"9dd6389b44044f1db789833889df1c04"},{"type":"String","name":"catalogs_tobe_searched","value":{"type":"String","mode":"string"},"id":"1ce5fce149a843fe858b2414b1cfd677"}],"glide_variables":[{"type":"String","name":"search_term","id":"ae98d01e23de40f8895f9824b02f7d75"},{"type":"True/False","id":"953f7311b0c54ccda1a33129eb184073","name":"proceed"},{"type":"String","name":"catalog_item_id","id":"0bda0fd82f3545838a38a41395e5d713"},{"type":"String","name":"item_type","id":"947d3c51a7374632b4b0b8af8ec12ec5"},{"type":"String","name":"is_conversational","id":"342b9229e3fc49dda28c2ac7800a3f0b"},{"type":"Reference","table":"sys_user","id":"current-user","name":"user"}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":["admin","virtual_agent_admin","sn_customerservice.customer","sn_customerservice.consumer"],"scope":"cf50453a53f41300f4d2ddeeff7b12cb","domain":"global","id":"91404caeb773330024f1b948ee11a9f9","name":"Submit Request","key_phrases":["Submit Request"],"nlu_provider":"64c023c17300330021a044764df6a70e","nlu_model":"sn_csm_nlu_Customer_Service_NLU_Model","nlu_model_label":"","nlu_intent":"SubmitRequest","nlu_intent_label":"","flexible_conversation_switching":false,"design_category":"b28634c4b7b93300da7ab948ee11a93a","library":false}</design_definition>
        <design_topic_id>91404caeb773330024f1b948ee11a9f9</design_topic_id>
        <name>Submit Request</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-08-03 21:08:11</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_id>91e1dbdbdbda1010a458cd3f299619ab</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_cb_design_topic_91e1dbdbdbda1010a458cd3f299619ab</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-08-03 21:08:11</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
